// Code generated by gen-api-client. DO NOT EDIT.

package handler

import (
	"sync"

	"github.com/go-pantheon/fabrica-util/errors"
	intrav1 "github.com/go-pantheon/roma/gen/api/server/room/intra/v1"
	"google.golang.org/protobuf/proto"
)

// TakeProtoRoomTunnelResponse takes a proto message from pool and must call PutRoomResponseProto to put it back.
func TakeProtoRoomTunnelResponse(index, mod, seq int32, Obj int64, in proto.Message) (ret *intrav1.TunnelResponse, err error) {
	data, err := proto.Marshal(in)
	if err != nil {
		return nil, errors.Wrapf(err, "proto marshal failed. mod=%d seq=%d obj=%d", mod, seq, Obj)
	}

	return TakeBytesRoomTunnelResponse(index, mod, seq, Obj, data), nil
}

// TakeBytesRoomTunnelResponse takes a proto message from pool and must call PutRoomTunnelResponse to put it back.
func TakeBytesRoomTunnelResponse(index, mod, seq int32, Obj int64, data []byte) (p *intrav1.TunnelResponse) {
	p = getRoomTunnelResponse()

	p.Index = index
	p.Mod = mod
	p.Seq = seq
	p.Obj = Obj
	p.Data = data

	return p
}

func PutRoomTunnelResponse(p *intrav1.TunnelResponse) {
	putRoomTunnelResponse(p)
}

var roomTunnelResponsePool = sync.Pool{
	New: func() interface{} {
		return &intrav1.TunnelResponse{}
	},
}

func getRoomTunnelResponse() *intrav1.TunnelResponse {
	return roomTunnelResponsePool.Get().(*intrav1.TunnelResponse)
}

func putRoomTunnelResponse(p *intrav1.TunnelResponse) {
	if p == nil {
		return
	}

	p.Reset()
	roomTunnelResponsePool.Put(p)
}
